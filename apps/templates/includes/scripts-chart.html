<script>
    
    const EMOTION_DEFAULT_VALUE = {}
    for (let i = 0; i < 8; i++) {
        EMOTION_DEFAULT_VALUE[i]=0;
    }
    const EMOTION_IDS=Object.keys(EMOTION_DEFAULT_VALUE);
    
    $(function(){
        $.ajax({
            url:'/fetch_chart',
            method: 'POST',
            success:function(response){
                const emotion_counts=Object.assign({}, EMOTION_DEFAULT_VALUE);
                // const eids=[], counts=[];
                for (let i = 0; i < response.result.length; i++) {
                    const e = response.result[i];
                    // eids.push(e.eid) // thay gia tri emotion
                    // emonames.push(e.emoname)
                    // counts.push(e.count)
                    emotion_counts[e.eid] = e.count;
                }
                const count_values=Object.values(emotion_counts);
                console.log(response.result,EMOTION_IDS,count_values);

                const ctx_1 = document.getElementById('chart-1').getContext('2d');
                const myChart_1 = new Chart(ctx_1, {
                    type: 'doughnut',
                    data: {
                        labels: Object.values(LABEL_VALUES),
                        // labels: emonames,
                        datasets: [{
                            label: '# of emotions',
                            data: count_values,
                            backgroundColor: [
                                'rgba(231, 30, 36, 0.8)',
                                'rgba(255, 99, 132, 1)',
                                'rgba(153, 102, 255, 1)',
                                'rgba(255, 159, 64, 1)',
                                'rgba(74, 184, 71, 0.8)',
                                'rgba(26, 97, 175, 0.8)',
                                'rgba(255, 206, 86, 1)',
                                'rgba(75, 192, 192, 1)',
                            ],
                            borderColor: [
                                'rgba(231, 30, 36, 0.8)',
                                'rgba(255, 99, 132, 1)',
                                'rgba(153, 102, 255, 1)',
                                'rgba(255, 159, 64, 1)',
                                'rgba(74, 184, 71, 0.8)',
                                'rgba(26, 97, 175, 0.8)',
                                'rgba(255, 206, 86, 1)',
                                'rgba(75, 192, 192, 1)',
                            ],
                            borderWidth: 1,
                            hoverOffset: 4
                        }]
                    }
                });

                const ctx_2 = document.getElementById('chart-2').getContext('2d'); // https://www.chartjs.org/docs/latest/samples/area/line-datasets.html
                const myChart_2 = new Chart(ctx_2, {
                    type: 'line',
                    data: {
                        labels: eids,
                        datasets: [{
                            label: '# of emotions',
                            data: counts,
                            backgroundColor: [
                                'rgba(231, 30, 36, 0.8)',
                                'rgba(255, 99, 132, 1)',
                                'rgba(153, 102, 255, 1)',
                                'rgba(255, 159, 64, 1)',
                                'rgba(74, 184, 71, 0.8)',
                                'rgba(26, 97, 175, 0.8)',
                                'rgba(255, 206, 86, 1)',
                                'rgba(75, 192, 192, 1)',
                            ],
                            borderColor: [
                                'rgba(231, 30, 36, 0.8)',
                                'rgba(255, 99, 132, 1)',
                                'rgba(153, 102, 255, 1)',
                                'rgba(255, 159, 64, 1)',
                                'rgba(74, 184, 71, 0.8)',
                                'rgba(26, 97, 175, 0.8)',
                                'rgba(255, 206, 86, 1)',
                                'rgba(75, 192, 192, 1)',
                            ],
                            borderWidth: 1,
                            hoverOffset: 4
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                position: 'top',
                            },
                            title: {
                                display: true,
                                text: 'Track Week'
                            }
                        }
                    },
                });

                
            }
        })
    });

</script>